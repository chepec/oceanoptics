This function needs to be re-written (it's half-way finished but needs to be completed)\ldots
